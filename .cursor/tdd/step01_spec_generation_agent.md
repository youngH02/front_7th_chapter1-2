# Spec Generation Agent Rule

# **STEP01. 기능 스펙 생성**

## 📍 현재 단계: 1️⃣ 기능 스펙 생성

**역할**: 사용자가 입력한 기능 명세를 분석하여 구조화된 spec 문서를 생성합니다. 후속 TDD 단계들이 참조할 수 있는 명확한 기능 정의와 요구사항을 작성합니다.

**⚠️ 필수 규칙 참조 (매 단계 적용)**: 이 단계 실행 전 반드시 다음 규칙을 읽고 준수

- [코드 컨벤션](mdc:.cursor/rules/00. foundation/code_conventions.mdc): 모든 코드 작성 시 엄격히 준수
- [커밋 컨벤션](mdc:.cursor/rules/00. foundation/commit_conventions.mdc): 커밋 메시지 작성 시 준수
- [프로젝트 구조](mdc:.cursor/rules/00. foundation/project_structure.mdc): 파일 배치 및 경로 결정 시 준수
- **⚠️ 언어 규칙 (절대 필수)**: 모든 문서 및 코드 주석은 **한글과 영어만 사용**해야 합니다. 중국어, 일본어 등 다른 언어는 절대 사용 금지

## 실행 절차

1. **입력 분석**: 사용자 명세를 분석하여 명확성과 완전성 평가
2. **정보 부족 확인**: 모호하거나 누락된 정보가 있는지 확인
3. **필요시 질의**: 정보가 부족하면 사용자에게 구체적인 질문을 통해 추가 정보 요청
4. **기존 명세서 검토**: `docs/project_spec` 폴더의 기존 명세서를 검토하여 번호 결정
5. **명세 문서 작성**: 충분한 정보를 바탕으로 구조화된 요구사항으로 변환
   - **⚠️ 필수**: 모든 요구사항에 명확한 번호 부여 (1, 1.1, 1.2.3 형식)
   - 최상위 섹션: ### 1. 기능명, ### 2. 기능명
   - 하위 섹션: #### 1.1. 하위 기능명, #### 2.1. 하위 기능명
   - 세부 항목: ##### 1.1.1. 세부 항목
6. **파일 저장**: `docs/project_spec/###_slug.md` 형식으로 저장 (###는 다음 번호)
7. **번호 매기기 검증**: 작성한 명세서의 모든 요구사항이 번호로 매겨져 있는지 확인
8. **⚠️ 파일 오류 확인 (절대 필수)**: 파일 저장 후 모든 오류를 확인해야 합니다
   - **파일 저장 확인**: 파일이 올바른 경로에 제대로 저장되었는지 확인
   - **마크다운 문법 확인**: 마크다운 문법 오류가 없는지 확인 (제목, 목록, 테이블 등)
   - **Linter 오류 확인**: `read_lints` 도구를 사용하여 파일의 linter 오류 확인
   - **파일 경로 확인**: 파일 경로가 `docs/project_spec/###_기능명.md` 형식을 따르는지 확인
   - **파일 내용 확인**: 저장된 파일을 `read_file` 도구로 다시 읽어 내용이 올바르게 저장되었는지 확인
   - 오류가 있으면 수정 후 8단계를 반복하여 모든 오류가 해결될 때까지 확인합니다
9. **⚠️ STEP01 요약 표시 (절대 필수)**: 모든 오류 확인 완료 후 아래 형식으로 STEP01 요약 표를 화면에 표시합니다

- STEP01 기능 스펙 문서 생성 요약 (반드시 화면에 표시!)

**⚠️ 필수**: 커밋 전에 반드시 아래 형식으로 화면에 표시하여 사용자가 확인할 수 있도록 해야 합니다!

```markdown
# 📋 STEP01 기능 스펙 문서 생성 요약

| 항목        | 내용                             |
| ----------- | -------------------------------- |
| 명세서 파일 | docs/project_spec/###\*기능명.md |
| 주요 기능   | [기능1, 기능2, ...]              |
| 다음 단계   | 2️⃣ 테스트 설계                   |
```

**⚠️ 중요**: 이 STEP01 요약을 화면에 표시하지 않고는 STEP01을 종료할 수 없습니다!

10. **⚠️ 커밋 실행 (절대 필수)**: 모든 오류 확인 및 요약 표시 완료 후, 이 단계를 마치기 전에 반드시 실제 git 커밋을 실행해야 합니다

  - `run_terminal_cmd` 도구를 사용하여 다음 명령을 실행:

  ```bash
  git add docs/project_spec/###_기능명.md
  git commit -m "chore(docs): add spec for [기능명]" \
    -m "Summary:
  - [기능 개요 요약]
  주요 기능:
  - [기능1]
  - [기능2]
  - ...

  File:
  - docs/project_spec/###_기능명.md"
  ```

  - **⚠️ 파일 오류 확인 완료 후에만 커밋 실행**: 8단계의 모든 파일 오류 확인이 완료되고, 9단계의 요약 표시가 완료된 후에만 커밋을 실행합니다
  - **커밋이 성공적으로 완료될 때까지 이 단계를 절대 종료하지 않음**
  - 커밋 실패 시 에러를 확인하고 재시도
  - 커밋 완료 후 자동으로 다음 단계(STEP02)로 진행합니다

## 명세서 구조 템플릿

**⚠️ 필수**: 모든 요구사항은 명확한 번호로 매겨져야 합니다!

```markdown
# 기능명

## 기능 개요

한 문장으로 기능을 설명

## 상세 요구사항

### 1. 기능명 1

1.1. 하위 요구사항 1

- 구체적인 내용 설명
- 입력/출력 명시

  1.2. 하위 요구사항 2

- 구체적인 내용 설명
- 행동/결과 명시

### 2. 기능명 2

2.1. 하위 요구사항 1

- 구체적인 내용 설명

### 3. 기능명 3

3.1. 하위 요구사항 1
...

### 특수 케이스

1. 예외 상황 1: 상세 설명
2. 예외 상황 2: 상세 설명
3. 경계 조건 1: 상세 설명

### 에러 처리

1. 에러 상황 1: 처리 방법
2. 에러 상황 2: 처리 방법

### 제약사항

1. 구현 제약 1
2. 구현 제약 2
3. 성능 고려사항

## 기술적 맥락

- 언어, 프레임워크 등 기술 스택
- 기존 코드베이스와의 연관성
```

### 번호 매기기 규칙 (필수)

1. **최상위 섹션**: 1, 2, 3... (### 1. 기능명)
2. **하위 섹션**: 1.1, 1.2, 2.1... (#### 1.1. 하위 기능명)
3. **세부 항목**: 1.1.1, 1.1.2, 1.2.1... (##### 1.1.1. 세부 항목)
4. **리스트**: 1), 2), 3)... 또는 -, \*, + 기호 사용

**예시**:

```
### 1. 일정 추가 기능

1.1. 기본 일정 추가
- 제목, 날짜, 시간 입력
- 유효성 검증

1.2. 고급 옵션
- 반복 설정
- 알림 설정

### 2. 일정 수정 기능

2.1. 기본 정보 수정
2.2. 시간 수정
```

## 작성 규칙

- **명확성**: 각 요구사항은 독립적으로 이해 가능해야 함
- **구체성**: "사용자가 ...하면 ...해야 한다" 형식으로 명확히 서술
- **테스트 가능성**: 각 요구사항은 테스트로 검증 가능해야 함
- **완전성**: 정상 케이스, 예외 케이스, 경계 조건 모두 포함
- **요약식 구조**: 가능한 한 간결하게, 필요시 섹션으로 구분
- **문서 번호**: 기존 명세서 번호 확인 후 다음 번호 사용
- **⚠️ 번호 매기기**: 모든 요구사항에 명확한 번호 부여 (1, 1.1, 1.2.3 형식)
  - 최상위: ### 1. 기능명, ### 2. 기능명
  - 하위: #### 1.1. 하위 기능명, #### 1.2. 하위 기능명
  - 세부: ##### 1.1.1. 세부 항목, ##### 1.1.2. 세부 항목
  - 각 섹션마다 순차적으로 번호 부여
